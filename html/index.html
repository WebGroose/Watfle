<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title></title>
	<link rel="stylesheet" type="text/css" href="css/index.css">
	<!-- axios -->
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
	<!-- top part -->
	<header>
		<div class="top" style="text-align:center">
			<a href=".html">Review</a> &nbsp;&nbsp;
			(<a href=".html">왓챠</a>&nbsp;
			<a href=".html">넷플</a>)&nbsp;&nbsp;
			<a href=".html" id="search">검색창</a>&nbsp;&nbsp;
			<a href=".html" >계정관리</a>&nbsp;&nbsp;
			<input type="text" name="query" placeholder="검색">
			<input type="button" name="search" value="검색">
			<ul class="search-list"></ul><!-- search-list--display-none -->
		</div>
	</header>
	<!--content part-->
	<div class="topMovie"> <!--style="text-align:center"-->
		<p align="center">
			<img src="img/lalaland.jpg" width="250px"height="350px"align="left">
			<div style=" width:800px;height:285px;">
				<strong>리뷰</strong><br>
				황홀한 사랑, 순수한 희망, 격렬한 열정...이 곳에서 모든 감정이 폭발한다!
				꿈을 꾸는 사람들을 위한 별들의 도시 ‘라라랜드’.
				재즈 피아니스트 ‘세바스찬’(라이언 고슬링)과 배우 지망생 ‘미아’(엠마 스톤)
				인생에서 가장 빛나는 순간 만난 두 사람은
				미완성인 서로의 무대를 만들어가기 시작한다.
			</div>
		</p>
	</div>
	<div class="underMovie">
		<p align="center">
			<br><br><br>
			<a href=" .html"><img src="img/time.jpg" width="200px"height="300px" >&nbsp;</a>
			<a href=" .html"><img src="img/notebook.jpg" width="200px"height="300px" >&nbsp;</a>
			<a href=" .html "><img src="img/potter.jpg" width="200px"height="300px" >&nbsp;</a>
			<a href=" .html "><img src="img/beast.jpg" width="200px"height="300px" ></a>
		</p>
	</div>
	<script type="text/javascript">
		const $ = document.querySelector.bind(document);
		const $$ = document.querySelectorAll.bind(document);

		axios.defaults.baseURL = 'http://watfle2.dothome.co.kr';

		const app = {
			init () {
				// $('input[name=query]').addEventListener('keyup', app.sendQuery);
				$('input[name=search]').addEventListener('click', app.sendQuery);
				// $('input[name=query]').addEventListener('focusin', app.showSearchList);
				// $('input[name=query]').addEventListener('focusout', app.hideSearchList);
			},
			sendQuery () {
				axios.get('/server/search.php?query='+$('input[name=query]').value)
				.then(function (response) {
					console.log(response.data);
					let resultTag = '';
					if (response.data.length == 0) resultTag = '검색 결과가 없습니다 ㅠ0ㅠ';
					else response.data.forEach(v => {
						let providerTag = '';
						v.provider.forEach(w => { providerTag += '<span class="search-list__tag">'+w+'</span>'; });
						resultTag += '<li><a href="piece.html?id='+v.id+'" class="search-list__item-link">'+v.title+'<span>'+providerTag+'</span></a></li>'; });
					$('.search-list').innerHTML = resultTag;
				})
				.catch(function (error) {
					console.log(error);
				});
			},
			showSearchList () {
				console.log('focusin');
				$('.search-list').classList.remove('search-list--display-none');
			},
			hideSearchList () {
				console.log('focusout');
				setTimeout(() => { $('.search-list').classList.add('search-list--display-none'); }, 100);
			}
		};

		document.addEventListener('DOMContentLoaded', app.init);
	</script>
</body>
</html>